<!DOCTYPE HTML>
<html lang="en" class="ayu" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>What is the relationship really? - Lesan</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="./css/animation-bench.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('ayu')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">User Guide</li><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="getting_start.html"><strong aria-hidden="true">2.</strong> Getting start</a></li><li class="chapter-item expanded "><a href="add_relation.html"><strong aria-hidden="true">3.</strong> Add relation</a></li><li class="chapter-item expanded "><a href="add_more_relation.html"><strong aria-hidden="true">4.</strong> Add more relation</a></li><li class="chapter-item expanded "><a href="mannage_relations.html"><strong aria-hidden="true">5.</strong> Mannage relations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="add_relation_fn.html"><strong aria-hidden="true">5.1.</strong> addRelation function</a></li><li class="chapter-item expanded "><a href="remove_relation_fn.html"><strong aria-hidden="true">5.2.</strong> removeRelation function</a></li><li class="chapter-item expanded "><a href="what_is_the_relationship.html" class="active"><strong aria-hidden="true">5.3.</strong> What is the relationship really?</a></li></ol></li><li class="chapter-item expanded "><a href="findOne_and_find_fn.html"><strong aria-hidden="true">6.</strong> findOne and find functions</a></li><li class="chapter-item expanded "><a href="aggregation_fn.html"><strong aria-hidden="true">7.</strong> aggregation functions</a></li><li class="chapter-item expanded "><a href="find_one_and_update_functions.html"><strong aria-hidden="true">8.</strong> findOneAndUpdate functions</a></li><li class="chapter-item expanded "><a href="delete_one_fn.html"><strong aria-hidden="true">9.</strong> deleteOne functions</a></li><li class="chapter-item expanded "><a href="insert_many_fn.html"><strong aria-hidden="true">10.</strong> insertMany functions</a></li><li class="chapter-item expanded "><a href="playground.html"><strong aria-hidden="true">11.</strong> Playground</a></li><li class="chapter-item expanded "><a href="all_advantages_of_lesan.html"><strong aria-hidden="true">12.</strong> All the advantages of Lesan</a></li><li class="chapter-item expanded affix "><li class="part-title">Advanced Guide</li><li class="chapter-item expanded "><a href="an_advanced_project.html"><strong aria-hidden="true">13.</strong> Implement an advanced project</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="advanced_general_description.html"><strong aria-hidden="true">13.1.</strong> General description</a></li><li class="chapter-item expanded "><a href="advanced_nx_config.html"><strong aria-hidden="true">13.2.</strong> nx configuration</a></li><li class="chapter-item expanded "><a href="folder_structure.html"><strong aria-hidden="true">13.3.</strong> Folder Structure</a></li><li class="chapter-item expanded "><a href="microservice-monolithic.html"><strong aria-hidden="true">13.4.</strong> Microservice or Monolithic</a></li></ol></li><li class="chapter-item expanded "><a href="manage_replica.html"><strong aria-hidden="true">14.</strong> Manage replica</a></li><li class="chapter-item expanded affix "><li class="part-title">Lesan Philosophy</li><li class="chapter-item expanded "><a href="Receiving_Data.html"><strong aria-hidden="true">15.</strong> Receiving Data</a></li><li class="chapter-item expanded "><a href="Previous_methods_and_the_main_challenge.html"><strong aria-hidden="true">16.</strong> Previous methods and the main challenge</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Lesan's_Solution_For_How_To_Communicate_Between_The_Server_And_The_Client.html"><strong aria-hidden="true">16.1.</strong> Lesan's Solution For How To Communicate Between The Server And The Client</a></li><li class="chapter-item expanded "><a href="Why_NoSQL.html"><strong aria-hidden="true">16.2.</strong> Why noSQL?</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Penetration_Into_Depths.html"><strong aria-hidden="true">16.2.1.</strong> Penetration Into Depths</a></li></ol></li><li class="chapter-item expanded "><a href="Microservice.html"><strong aria-hidden="true">16.3.</strong> Microservice</a></li><li class="chapter-item expanded "><a href="Lesan_solution.html"><strong aria-hidden="true">16.4.</strong> Lesan solution</a></li></ol></li><li class="chapter-item expanded "><a href="Starting_work_with_Lesan.html"><strong aria-hidden="true">17.</strong> Starting work with Lesan</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Microservice_Architecture_with_Lesan.html"><strong aria-hidden="true">17.1.</strong> Microservice Architecture with Lesan</a></li></ol></li><li class="chapter-item expanded "><a href="Structures.html"><strong aria-hidden="true">18.</strong> Structures</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Schemas.html"><strong aria-hidden="true">18.1.</strong> Schemas</a></li><li class="chapter-item expanded "><a href="Pure_Structure_In_Schema.html"><strong aria-hidden="true">18.2.</strong> Pure Structure In Schema</a></li><li class="chapter-item expanded "><a href="The_InRelation_Structure_In_Schema.html"><strong aria-hidden="true">18.3.</strong> The InRelation Structure In Schema</a></li><li class="chapter-item expanded "><a href="The_structure_of_OutRelation_in_the_schema.html"><strong aria-hidden="true">18.4.</strong> The structure of OutRelation in the schema</a></li><li class="chapter-item expanded "><a href="The_structure_of_embed_in_the_schema.html"><strong aria-hidden="true">18.5.</strong> The structure of embed in the schema</a></li><li class="chapter-item expanded "><a href="The_structure_of_Struct_in_the_schema.html"><strong aria-hidden="true">18.6.</strong> The structure of Struct in the schema</a></li><li class="chapter-item expanded "><a href="runServer_(web_server_structure).html"><strong aria-hidden="true">18.7.</strong> runServer (web server structure)</a></li><li class="chapter-item expanded "><a href="Request_processing.html"><strong aria-hidden="true">18.8.</strong> Request processing</a></li><li class="chapter-item expanded "><a href="Dynamic_structure.html"><strong aria-hidden="true">18.9.</strong> Dynamic structure</a></li><li class="chapter-item expanded "><a href="Static_structure.html"><strong aria-hidden="true">18.10.</strong> Static structure</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">API Reference</li><li class="chapter-item expanded "><a href="api/lesan_fn.html"><strong aria-hidden="true">19.</strong> lesan</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/schemas_fn.html"><strong aria-hidden="true">19.1.</strong> schemas</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/schemaFns/schemaFns_fn.html"><strong aria-hidden="true">19.1.1.</strong> schemaFns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/schemaFns/getSchemas_fn.html"><strong aria-hidden="true">19.1.1.1.</strong> getSchemas</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/getPureOfMainRelations_fn.html"><strong aria-hidden="true">19.1.1.2.</strong> getPureOfMainRelations</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/getSchema_fn.html"><strong aria-hidden="true">19.1.1.3.</strong> getSchema</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/getPureSchema_fn.html"><strong aria-hidden="true">19.1.1.4.</strong> getPureSchema</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/getPureFromMainRelations_fn.html"><strong aria-hidden="true">19.1.1.5.</strong> getPureFromMainRelations</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/getPureFromRelatedRelations_fn.html"><strong aria-hidden="true">19.1.1.6.</strong> getPureFromRelatedRelations</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/createEmbedded_fn.html"><strong aria-hidden="true">19.1.1.7.</strong> createEmbedded</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/createStruct_fn.html"><strong aria-hidden="true">19.1.1.8.</strong> createStruct</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/_fn.html"><strong aria-hidden="true">19.1.1.9.</strong> getSchemasKeys</a></li></ol></li><li class="chapter-item expanded "><a href="api/schemas/mainRelationsFns/mainRelations_Fns.html"><strong aria-hidden="true">19.1.2.</strong> mainRelationsFns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/mainRelationsFns/getMainRelations_fn.html"><strong aria-hidden="true">19.1.2.1.</strong> getMainRelations</a></li></ol></li><li class="chapter-item expanded "><a href="api/schemas/relatedRelationFns/relatedRelation_Fns.html"><strong aria-hidden="true">19.1.3.</strong> relatedRelationFns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/relatedRelationFns/getRelatedRelations_fn.html"><strong aria-hidden="true">19.1.3.1.</strong> getRelatedRelations</a></li></ol></li><li class="chapter-item expanded "><a href="api/schemas/pureFns/pure_Fns.html"><strong aria-hidden="true">19.1.4.</strong> pureFns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/pureFns/addPureModel_Fns.html"><strong aria-hidden="true">19.1.4.1.</strong> addPureModel</a></li><li class="chapter-item expanded "><a href="api/schemas/pureFns/getPureModel_Fns.html"><strong aria-hidden="true">19.1.4.2.</strong> getPureModel</a></li><li class="chapter-item expanded "><a href="api/schemas/pureFns/getPureModelByNameAndKey_Fns.html"><strong aria-hidden="true">19.1.4.3.</strong> getPureModelByNameAndKey</a></li></ol></li><li class="chapter-item expanded "><a href="api/schemas/relationFns/relation_Fns.html"><strong aria-hidden="true">19.1.5.</strong> relationFns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/relationFns/getRelation_Fns.html"><strong aria-hidden="true">19.1.5.1.</strong> getRelation</a></li></ol></li><li class="chapter-item expanded "><a href="api/schemas/selectStructFns/selectStruct_Fns.html"><strong aria-hidden="true">19.1.6.</strong> selectStructFns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/selectStructFns/fieldType_Fns.html"><strong aria-hidden="true">19.1.6.1.</strong> fieldType</a></li><li class="chapter-item expanded "><a href="api/schemas/selectStructFns/decreaseIterate_Fns.html"><strong aria-hidden="true">19.1.6.2.</strong> decreaseIterate</a></li><li class="chapter-item expanded "><a href="api/schemas/selectStructFns/checkRelation_Fns.html"><strong aria-hidden="true">19.1.6.3.</strong> checkRelation</a></li><li class="chapter-item expanded "><a href="api/schemas/selectStructFns/selectStruct_Fns.html"><strong aria-hidden="true">19.1.6.4.</strong> selectStruct</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="api/acts/acts_fn.html"><strong aria-hidden="true">19.2.</strong> acts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/acts/setAct/setAct_Fns.html"><strong aria-hidden="true">19.2.1.</strong> setAct</a></li><li class="chapter-item expanded "><a href="api/acts/getServiceKeys/getServiceKeys_Fns.html"><strong aria-hidden="true">19.2.2.</strong> getServiceKeys</a></li><li class="chapter-item expanded "><a href="api/acts/getActs/getActs_Fns.html"><strong aria-hidden="true">19.2.3.</strong> getActs</a></li><li class="chapter-item expanded "><a href="api/acts/getActsKeys/getActsKeys_Fns.html"><strong aria-hidden="true">19.2.4.</strong> getActsKeys</a></li><li class="chapter-item expanded "><a href="api/acts/getAct/getAct_Fns.html"><strong aria-hidden="true">19.2.5.</strong> getAct</a></li><li class="chapter-item expanded "><a href="api/acts/getAtcsWithServices/getAtcsWithServices_Fns.html"><strong aria-hidden="true">19.2.6.</strong> getAtcsWithServices</a></li><li class="chapter-item expanded "><a href="api/acts/getMainActs/getMainActs_Fns.html"><strong aria-hidden="true">19.2.7.</strong> getMainActs</a></li><li class="chapter-item expanded "><a href="api/acts/getMainAct/getMainAct_Fns.html"><strong aria-hidden="true">19.2.8.</strong> getMainAct</a></li><li class="chapter-item expanded "><a href="api/acts/setService/setService_Fns.html"><strong aria-hidden="true">19.2.9.</strong> setService</a></li><li class="chapter-item expanded "><a href="api/acts/getService/getService_Fns.html"><strong aria-hidden="true">19.2.10.</strong> getService</a></li></ol></li><li class="chapter-item expanded "><a href="api/odm/odm_fn.html"><strong aria-hidden="true">19.3.</strong> odm</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/odm/setDb/setDb_Fns.html"><strong aria-hidden="true">19.3.1.</strong> setDb</a></li><li class="chapter-item expanded "><a href="api/odm/getCollection/getCollection_Fns.html"><strong aria-hidden="true">19.3.2.</strong> getCollection</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/newModel_Fns.html"><strong aria-hidden="true">19.3.3.</strong> newModel</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/odm/newModel/find_Fns.html"><strong aria-hidden="true">19.3.3.1.</strong> find</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/findOne_Fns.html"><strong aria-hidden="true">19.3.3.2.</strong> findOne</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/insertOne_Fns.html"><strong aria-hidden="true">19.3.3.3.</strong> insertOne</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/insertMany_Fns.html"><strong aria-hidden="true">19.3.3.4.</strong> insertMany</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/addRelation_Fns.html"><strong aria-hidden="true">19.3.3.5.</strong> addRelation</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/removeRelation_Fns.html"><strong aria-hidden="true">19.3.3.6.</strong> removeRelation</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/findOneAndUpdate_Fns.html"><strong aria-hidden="true">19.3.3.7.</strong> findOneAndUpdate</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/deleteOne_Fns.html"><strong aria-hidden="true">19.3.3.8.</strong> deleteOne</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/aggregation_Fns.html"><strong aria-hidden="true">19.3.3.9.</strong> aggregation</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="api/context/contextFns_fn.html"><strong aria-hidden="true">19.4.</strong> contextFns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/context/getContextModel/getContextModel_Fns.html"><strong aria-hidden="true">19.4.1.</strong> getContextModel</a></li><li class="chapter-item expanded "><a href="api/context/setContext/setContext_Fns.html"><strong aria-hidden="true">19.4.2.</strong> setContext</a></li><li class="chapter-item expanded "><a href="api/context/getContextModel/addContexts_Fns.html"><strong aria-hidden="true">19.4.3.</strong> addContexts</a></li><li class="chapter-item expanded "><a href="api/context/getContextModel/addReqToContext_Fns.html"><strong aria-hidden="true">19.4.4.</strong> addReqToContext</a></li><li class="chapter-item expanded "><a href="api/context/getContextModel/addHeaderToContext_Fns.html"><strong aria-hidden="true">19.4.5.</strong> addHeaderToContext</a></li><li class="chapter-item expanded "><a href="api/context/getContextModel/addBodyToContext_Fns.html"><strong aria-hidden="true">19.4.6.</strong> addBodyToContext</a></li></ol></li><li class="chapter-item expanded "><a href="api/runServer/runServer_fn.html"><strong aria-hidden="true">19.5.</strong> runServer</a></li><li class="chapter-item expanded "><a href="api/generateSchema/generateSchemTypes_fn.html"><strong aria-hidden="true">19.6.</strong> generateSchemTypes</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Lesan</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/MiaadTeam/lesan" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/MiaadTeam/lesan/tree/main/pages/src/what_is_the_relationship.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="what-is-the-relationship-really"><a class="header" href="#what-is-the-relationship-really">What is the relationship really?</a></h1>
<p>Let's compare a bit, it may be funny, but let's do it.</p>
<p>what are a real relationship between <code>People</code>?</p>
<ul>
<li>Right relationships are lasting and long -term.</li>
<li>Both parties accept responsibility for relationships and changes.</li>
<li>Changes on one side of the relationship also affect the other side.</li>
<li>The two sides of a relationship live together.</li>
<li>If the relationship leads to the birth of a child, both parties will accept the relationship.</li>
</ul>
<p>Now let's look at the relationship features in <code>SQL</code>:</p>
<ul>
<li>There is no real relationship. The two sides have only one connection.</li>
<li>Relationships are not together. And each lives independently.</li>
<li>Relationships are not deep.</li>
<li>Relationships do not give birth to any children. (In <strong>Lesan</strong>, you will see that relationships encourage you to create new models)</li>
</ul>
<p>What are the relationships in <code>NoSQL</code>?</p>
<ul>
<li>There is no real relationship. In fact, there is no proper connection between the two sides.</li>
<li>If we consider embeding as a relationship: 
<ul>
<li>the changes of each party have no effect on the other side and cause many inconsistencies in the data.</li>
<li>the two sides leave each other after the relationship.</li>
</ul>
</li>
<li>In this type of databases, they prevent the child from being born, and if a child is born, only one side will be informed of it and probably will not take much responsibility for it.</li>
</ul>
<p>And finally what are the relationships in <code>Lesan</code>:</p>
<ul>
<li>Relationships are as strong as possible, and are described in detail when creating a model.</li>
<li>Relationships fully contain each other's pure properties within themselves.</li>
<li>If a relationship changes, all related parties will be notified and apply the changes according to a process.</li>
<li>By establishing a relationship and seeing many changes on one side of this relationship, you are encouraged to create new relationships. Don't worry, this issue will not add more complexity to the data model, but it will also make the data more understandable. (Below there is an example to understand this)</li>
</ul>
<h2 id="example"><a class="header" href="#example">Example</a></h2>
<h3 id="sql"><a class="header" href="#sql">SQL</a></h3>
<p>So let's go back to our example (countries, cities and users)<br />
If we want to define a relationship between the country, city and user models in <code>SQL</code>, this relationship will be as follows (The code below is written for <code>PostgreSQL</code>):</p>
<pre><code class="language-sql">CREATE TABLE country (
  id serial PRIMARY KEY,
  name VARCHAR ( 50 ) UNIQUE NOT NULL,
  abb VARCHAR ( 50 ) NOT NULL,
  population INT NOT NULL,
);

CREATE TABLE city (
  id serial PRIMARY KEY,
  name VARCHAR ( 50 ) UNIQUE NOT NULL,
  abb VARCHAR ( 50 ) NOT NULL,
  population INT NOT NULL,
  country_id INT NOT NULL,
  FOREIGN KEY (country_id)
    REFERENCES country (country_id),
);

CREATE TABLE user (
  id serial PRIMARY KEY,
  name VARCHAR ( 50 ) UNIQUE NOT NULL,
  age INT NOT NULL,
  country_id INT NOT NULL,
  FOREIGN KEY (country_id)
    REFERENCES country (country_id),
  city_id INT NOT NULL,
  FOREIGN KEY (city_id)
    REFERENCES city_id (city_id),
);

</code></pre>
<p>Pay attention that the relationships are separated from each other as much as possible and only one ID is kept on one side. Whenever we need to know the details of the relationship, we have to visit both sides of the relationship.<br />
For example, let's imagine that we want the cities of Iran, we must first find Iran and then filter the city using Iran ID.<br />
Now let's imagine that we want to find the country of Iran along with its 50 most populated cities, we have to find Iran first, then find the cities according to the ID filter of the country of Iran along with the sort based on the city population field and the limit of 50.<br />
Let's run a more complex query. Suppose we want to receive 50 most populous cities from the 50 most populous countries in the world.<br />
Or we want to find the oldest people in the 50 most populous countries in the world.<br />
To get the above cities or users, we have to create and execute much more complex queries that may be time-consuming in some cases, although there are alternative ways such as creating separate tables in SQL for these specific purposes, but these ways also add a lot of complexity to the project.</p>
<h3 id="nosql"><a class="header" href="#nosql">NoSQL</a></h3>
<p>What if we could do the above with just a simple query? <code>NoSQL</code> is designed for this, let's see how these tables are implemented in <code>NoSQL</code> databases (Here we have used <code>mongoose</code> so that we can have the shape of the schemas):</p>
<pre><code class="language-ts">const CountrySchema = new mongoose.Schema ({
	name: String,
	abb: String,
	population: Number,
});
const Country = mongoose.model(&quot;Country&quot;, CountrySchema)

const CitySchema = new mongoose.Schema ({
	name: String,
	abb: String,
	population: Number,
	country: {
		type: mongoose.Schema.Types.ObjectId,
		ref: Country
	} 
});
const City = mongoose.model(&quot;City&quot;, CitySchema)

const UserSchema = new mongoose.Schema ({
	name: String,
	age: Number,
	country: {
		type: mongoose.Schema.Types.ObjectId,
		ref: Country
	},
	city: {
		type: mongoose.Schema.Types.ObjectId,
		ref: City
	} 
});
const User = mongoose.model(&quot;User&quot;, CitySchema)
</code></pre>
<p>The code above is exactly equivalent to the code we wrote for <code>PostgreSQL</code> and creates exactly the same tables in <code>MongoDB</code>. All the issues we described for <code>SQL</code> will be present here as well, but wait, we can add other fields to these tables to simplify the complex queries we talked about above.</p>
<p>We can store its cities inside each country by adding a field called cities. Pay attention to the following code:</p>
<pre><code class="language-ts">const CountrySchema = new mongoose.Schema ({
  name: String,
  abb: String,
  population: Number,
  cities: [{
    name: String,
    abb: String,
    population: Number,
  }]
});
</code></pre>
<p>Now we can get a country along with its cities just by sending a single query. For example, we can get the country of Iran along with its cities with just one query from the database. But wait, some new issues have arisen.</p>
<ul>
<li>How should we save the cities inside the country ?<br />
For this, it is necessary to find the country associated with the city in the function we write to add the city and add this new city to the cities field of that country. This means that when adding a city in the table of cities, we must insert a new record and edit a record in the table of countries.</li>
<li>Can we store all the cities of a country within itself ?<br />
The short answer is no, although it is possible that the number of cities in a country can be stored within the country, but in some situations, the number of documents that we need to store inside another document may be very large, such as the users of a country. So what should we do? Save a limited number of cities, how many? The number that we feel should be requested in the first pagination (for example, 50 numbers). So, in the function we have written to store the city, we must be aware that if the field of cities within the country has stored 50 cities within itself, do not add this new city to this field.</li>
<li>What if a city changes ?<br />
Well, as a rule, we should find the country related to that city and check whether this city is stored in the field of cities of that country or not, if yes, we should correct it.</li>
<li>What if a city is removed ?<br />
We need to find the country associated with the city and if this city is present in the field of cities of that country, we should modify that field as well. How? First, we remove this city from the array of cities, then we check whether this field has reached the limited number that we have previously considered for it, if yes, then this country may have other cities that are not in this field. So we need to find one of them and add it to this field.</li>
</ul>
<p>All this was added just so that we can have its cities when receiving a country!<br />
Don't worry, it's worth it. Because we usually add cities and countries once, besides, its information does not change much (except for the population, which we will talk about later). And on the other hand, these cities and countries will be received many times.</p>
<p>Now, what if we want to get the 50 most populous countries along with the 50 most populous cities of that country?<br />
We can add a new field to the country. Pay attention to the following code:</p>
<pre><code class="language-ts">const CountrySchema = new mongoose.Schema ({
  name: String,
  abb: String,
  population: Number,
  cities: [{
    name: String,
    abb: String,
    population: Number,
  }],
  mostPopulousCities: [{
    name: String,
    abb: String,
    population: Number,
  }],
});
</code></pre>
<p>For <code>mostPopulousCities</code> Field, we should consider all the events that happened above, although with a slight change:</p>
<ul>
<li>What if a city changes ?
We need to find the country associated with the city, then see if this city is stored in the <code>cities</code> and <code>mostPopulousCities</code> fields of this country or not. If it is stored in the <code>cities</code> field, we must do the same steps as above, but if it is stored in the <code>mostPopulousCities</code> field, we must first, see which city field has changed, if the population field has changed, this city may no longer be included in this list and we want to remove it from the list and add another city to this list based on its population, otherwise it is possible This city is not in the <code>mostPopulousCities</code> list at all, but due to the change in the city's population, we want to add it to this list. Note that this city may be added anywhere in this list, and on the other hand, if this list has reached the end of the predetermined capacity, we must remove a city from the end.</li>
</ul>
<h3 id="lesan"><a class="header" href="#lesan">Lesan</a></h3>
<p>So, if we want to create the same relationships with <strong>‌Lesan</strong>, what should we do?
Just enter the code below:</p>
<pre><code class="language-ts">// Country Model
const countryCityPure = {
  name: string(),
  population: number(),
  abb: string(),
};

const countryRelations = {};

const countries = coreApp.odm.newModel(
  &quot;country&quot;,
  countryCityPure,
  countryRelations,
);

// City Model
const cityRelations = {
  country: {
    optional: false,
    schemaName: &quot;country&quot;,
    type: &quot;single&quot; as RelationDataType,
    relatedRelations: {
      cities: {
        type: &quot;multiple&quot; as RelationDataType,
        limit: 50,
        sort: {
          field: &quot;_id&quot;,
          order: &quot;desc&quot; as RelationSortOrderType,
        },
      },
      mostPopulousCities: {
        type: &quot;multiple&quot; as RelationDataType,
        limit: 50,
        sort: {
          field: &quot;population&quot;,
          order: &quot;desc&quot; as RelationSortOrderType,
        },
      },
    },
  },
};

const cities = coreApp.odm.newModel(
  &quot;city&quot;,
  countryCityPure,
  cityRelations,
);

// User Model
const userPure = {
  name: string(),
  age: number(),
};

const userRelations = {
  country: {
    optional: false,
    schemaName: &quot;country&quot;,
    type: &quot;single&quot; as RelationDataType,
    relatedRelations: {
      users: {
        type: &quot;multiple&quot; as RelationDataType,
        limit: 50,
        sort: {
          field: &quot;_id&quot;,
          order: &quot;desc&quot; as RelationSortOrderType,
        },
      },
    },
  },
  city: {
    optional: false,
    schemaName: &quot;country&quot;,
    type: &quot;single&quot; as RelationDataType,
    relatedRelations: {
      users: {
        type: &quot;multiple&quot; as RelationDataType,
        limit: 50,
        sort: {
          field: &quot;_id&quot;,
          order: &quot;desc&quot; as RelationSortOrderType,
        },
      },
    },
  },
};

const users = coreApp.odm.newModel(
  &quot;user&quot;,
  userPure,
  userRelations,
);
</code></pre>
<p>In the code above, we have not defined any relationship for the country, but in fact, the country is related to both the city and the user, but this relationship is defined by them because they were the requesters of the relationship.<br />
If you pay attention, we have defined two <code>relatedRelations</code> for the country when defining city relations, which causes two fields called <code>cities</code> and <code>mostPopulousCities</code> to be added to the country schema. For the <code>cities</code> field, we have set the sort on <code>_id</code> and in <code>descending</code> order, and we have limited the capacity of the field to 50 numbers with the <code>limit</code> option, which causes the last 50 cities of each country to be stored in it.<br />
But in the <code>mostPopulousCities</code> field we have once again stored 50 cities in each country, but this time by sorting on the City <code>population</code> field.<br />
The important thing here is that all the things we said we need to do in <code>NoSQL</code> databases using <code>Mongoose</code> are done automatically in <code>Lesan</code> and you don't need any additional code to manage these relationships during <code>insert</code>, <code>update</code> or <code>delete</code>. All work will be done by <code>Lesan</code>.</p>
<h2 id="all-benefit-of-lesan-relationship"><a class="header" href="#all-benefit-of-lesan-relationship">All benefit of Lesan relationship</a></h2>
<p>اول راجع به ایمکه رابطه چی هست حرف می‌زنم، بعد می‌گم اس‌کیوال فقط کانکشن برقرار می‌کنه، بعد می‌گم نواس‌کیوال هم فقط امبد می‌کنه و مدیریت درست نداره.</p>
<p>بعد میام راجع به اینکه هر فیلد پر تغییری می‌تونه به رابطه تبدیل بشه حرف می‌زنم، مثال بانک و ثبت احوال کشورها رو می‌گم.</p>
<p>بعد میام راجع به اینکه رابطه‌های دو سر چندتایی نمی‌تونه دو سر بی انتها داشته باشه حرف می‌زنم و چندتا مثال می‌زنم.</p>
<p>بعد راجع به آپدیت شدن رابطه‌ها حرف می‌زنم.</p>
<p>بعد راجع به دیتابیس اینمموری حرف می‌زنم.</p>
<p>بعد راجع به مدیریت کیوکیو حرف می‌زنم.</p>
<p>حتما یادم باشه راجع به اینکه وقتی امبد می‌کنی چقدر دریافت داده‌ها راحت هست هم حرف بزنیم، از اون طرف راجع به اینکه فیلتر کردنشون بر اساس فیلد امبد شده چه معجزه‌ای میکنه هم حرف بزنم</p>
<p>حتما راجع به اینکه چه نکته‌هایی داره طراحی مدل توی لسان حرف بزنم یعنی اینکه بگم رابطه‌ها از یک طرف تعریف می‌شن بعد توی طرف بعدی از همینجا ساید افکت‌هاش مشخص میشه بگم و اینکه نگران نباشن چون توی پلی‌گراند می‌تونن برای یک مدل همه‌ی رابطه‌هایی که داره چه از طرف خودش تعریف شده باشه چه بقیه براش تعریف کرده باشن رو ببینه و یه عکس از پلی‌گراند بذارم، نکته مهمش اینه که بگم همیشه رابطه رو از طرف مهمش درخواست بدن تا بشه هر چقدر می‌خوایم ساید افکت مناسب براش بذاریم</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="remove_relation_fn.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="findOne_and_find_fn.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="remove_relation_fn.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="findOne_and_find_fn.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
